Hydra CONFIG_DIR: /home/dennis/cell-eval/src/baselines/state_sets_reproduce/configs
Start process
[rank: 0] Seed set to 42
data:
  name: PerturbationDataModule
  kwargs:
    toml_config_path: /home/dennis/cell-eval/src/baselines/state_sets_reproduce/configs/parse.toml
    embed_key: hvg
    output_space: gene
    pert_rep: onehot
    basal_rep: sample
    num_workers: 4
    pin_memory: true
    n_basal_samples: 1
    basal_mapping_strategy: batch
    should_yield_control_cells: true
    batch_col: donor
    pert_col: cytokine
    cell_type_key: donor
    control_pert: PBS
    map_controls: true
    perturbation_features_file: null
    store_raw_basal: false
    int_counts: false
  output_dir: null
  debug: true
model:
  name: CPA
  checkpoint: null
  device: cuda
  kwargs:
    n_latent: 64
    recon_loss: gauss
    pert_embeddings: null
    hidden_dim: 256
    n_hidden_encoder: 768
    n_layers_encoder: 4
    n_hidden_decoder: 768
    n_layers_decoder: 3
    use_batch_norm: decoder
    use_layer_norm: encoder
    dropout_rate_encoder: 0.15
    dropout_rate_decoder: 0.15
    n_hidden_adv: 64
    n_layers_adv: 2
    use_norm_adv: batch
    dropout_rate_adv: 0.2
    variational: false
    expr_transform: none
    seed: 2025
    cell_sentence_len: 1
    residual_decoder: false
    nb_decoder: false
    encode_dosage: false
    dosage_non_linearity: identity
training:
  max_steps: 10000
  train_seed: 42
  val_freq: 1000
  test_freq: 9000
  gradient_clip_val: 3
  n_epochs_kl_warmup: null
  n_steps_adv_warmup: 50000
  n_steps_pretrain_ae: 50000
  adv_steps: null
  reg_adv: 15.0
  pen_adv: 20.0
  lr: 0.0003
  wd: 4.0e-07
  adv_lr: 0.0005
  adv_wd: 4.0e-07
  step_size_lr: 25
  do_clip_grad: false
  adv_loss: cce
  batch_size: 128
wandb:
  entity: CPA-Parse-Donor
  project: CPA
  local_wandb_dir: ./wandb_logs
  tags: []
name: cpa_parse_example
output_dir: /home/dennis/cell-eval/src/baselines/outputs/cpa_parse_example
use_wandb: false
overwrite: false
return_adatas: false
pred_adata_path: null
true_adata_path: null

wandb done
[INFO] Using TOML configuration: /home/dennis/cell-eval/src/baselines/state_sets_reproduce/configs/parse.toml
[INFO] Loaded 1 datasets from TOML
[INFO] Zero-shot config: {}
[INFO] Few-shot config: {'parse.Donor1': {'val': ['G-CSF', 'IFN-beta', 'M-CSF', 'IGF-1'], 'test': ['C5a', 'TWEAK', 'LIF', 'IL-17C', 'FGF-beta', 'BAFF', 'FLT3L', 'IFN-lambda2', '4-1BBL', 'IL-17E', 'IL-2', 'IL-19', 'PRL', 'IL-16', 'IL-7', 'GM-CSF', 'IL-17A', 'IL-13', 'IL-36-alpha', 'PSPN', 'EPO', 'IL-9', 'IL-31', 'IL-11', 'LT-alpha1-beta2', 'TL1A', 'IL-32-beta', 'IFN-omega', 'IL-8', 'Noggin', 'IFN-epsilon', 'IL-17F', 'Leptin', 'IL-33', 'IL-35', 'OSM', 'IL-34', 'HGF', 'IL-1Ra', 'LIGHT', 'CD27L', 'SCF', 'IL-1-alpha', 'TGF-beta1', 'CD30L', 'IL-24', 'IFN-gamma', 'IFN-alpha1', 'IFN-lambda1', 'GITRL', 'VEGF', 'ADSF', 'IL-15', 'EGF', 'IL-3', 'IL-17B', 'IL-6', 'IL-4', 'IL-10', 'CT-1', 'IFN-lambda3', 'TRAIL']}, 'parse.Donor4': {'val': ['G-CSF', 'IFN-beta', 'M-CSF', 'IGF-1'], 'test': ['C5a', 'TWEAK', 'LIF', 'IL-17C', 'FGF-beta', 'BAFF', 'FLT3L', 'IFN-lambda2', '4-1BBL', 'IL-17E', 'IL-2', 'IL-19', 'PRL', 'IL-16', 'IL-7', 'GM-CSF', 'IL-17A', 'IL-13', 'IL-36-alpha', 'PSPN', 'EPO', 'IL-9', 'IL-31', 'IL-11', 'LT-alpha1-beta2', 'TL1A', 'IL-32-beta', 'IFN-omega', 'IL-8', 'Noggin', 'IFN-epsilon', 'IL-17F', 'Leptin', 'IL-33', 'IL-35', 'OSM', 'IL-34', 'HGF', 'IL-1Ra', 'LIGHT', 'CD27L', 'SCF', 'IL-1-alpha', 'TGF-beta1', 'CD30L', 'IL-24', 'IFN-gamma', 'IFN-alpha1', 'IFN-lambda1', 'GITRL', 'VEGF', 'ADSF', 'IL-15', 'EGF', 'IL-3', 'IL-17B', 'IL-6', 'IL-4', 'IL-10', 'CT-1', 'IFN-lambda3', 'TRAIL']}, 'parse.Donor9': {'val': ['G-CSF', 'IFN-beta', 'M-CSF', 'IGF-1'], 'test': ['C5a', 'TWEAK', 'LIF', 'IL-17C', 'FGF-beta', 'BAFF', 'FLT3L', 'IFN-lambda2', '4-1BBL', 'IL-17E', 'IL-2', 'IL-19', 'PRL', 'IL-16', 'IL-7', 'GM-CSF', 'IL-17A', 'IL-13', 'IL-36-alpha', 'PSPN', 'EPO', 'IL-9', 'IL-31', 'IL-11', 'LT-alpha1-beta2', 'TL1A', 'IL-32-beta', 'IFN-omega', 'IL-8', 'Noggin', 'IFN-epsilon', 'IL-17F', 'Leptin', 'IL-33', 'IL-35', 'OSM', 'IL-34', 'HGF', 'IL-1Ra', 'LIGHT', 'CD27L', 'SCF', 'IL-1-alpha', 'TGF-beta1', 'CD30L', 'IL-24', 'IFN-gamma', 'IFN-alpha1', 'IFN-lambda1', 'GITRL', 'VEGF', 'ADSF', 'IL-15', 'EGF', 'IL-3', 'IL-17B', 'IL-6', 'IL-4', 'IL-10', 'CT-1', 'IFN-lambda3', 'TRAIL']}, 'parse.Donor12': {'val': ['G-CSF', 'IFN-beta', 'M-CSF', 'IGF-1'], 'test': ['C5a', 'TWEAK', 'LIF', 'IL-17C', 'FGF-beta', 'BAFF', 'FLT3L', 'IFN-lambda2', '4-1BBL', 'IL-17E', 'IL-2', 'IL-19', 'PRL', 'IL-16', 'IL-7', 'GM-CSF', 'IL-17A', 'IL-13', 'IL-36-alpha', 'PSPN', 'EPO', 'IL-9', 'IL-31', 'IL-11', 'LT-alpha1-beta2', 'TL1A', 'IL-32-beta', 'IFN-omega', 'IL-8', 'Noggin', 'IFN-epsilon', 'IL-17F', 'Leptin', 'IL-33', 'IL-35', 'OSM', 'IL-34', 'HGF', 'IL-1Ra', 'LIGHT', 'CD27L', 'SCF', 'IL-1-alpha', 'TGF-beta1', 'CD30L', 'IL-24', 'IFN-gamma', 'IFN-alpha1', 'IFN-lambda1', 'GITRL', 'VEGF', 'ADSF', 'IL-15', 'EGF', 'IL-3', 'IL-17B', 'IL-6', 'IL-4', 'IL-10', 'CT-1', 'IFN-lambda3', 'TRAIL']}}
Loading data path...
Loading all data...
[INFO] Loading Parse_10M_PBMC_cytokines_hvg.h5ad...
